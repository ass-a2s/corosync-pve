From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fabian=20Gr=C3=BCnbichler?= <f.gruenbichler@proxmox.com>
Date: Wed, 22 May 2019 11:14:01 +0200
Subject: [PATCH] don't install default corosync.conf
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Fabian Gr√ºnbichler <f.gruenbichler@proxmox.com>
---
 .../Make-the-example-config-valid.patch       | 64 -------------------
 debian/corosync.install                       |  2 +-
 debian/rules                                  |  3 -
 3 files changed, 1 insertion(+), 68 deletions(-)
 delete mode 100644 debian/patches/Make-the-example-config-valid.patch

diff --git a/debian/patches/Make-the-example-config-valid.patch b/debian/patches/Make-the-example-config-valid.patch
deleted file mode 100644
index 5c2182f7..00000000
--- a/debian/patches/Make-the-example-config-valid.patch
+++ /dev/null
@@ -1,64 +0,0 @@
-From: =?utf-8?q?Ferenc_W=C3=A1gner?= <wferi@debian.org>
-Date: Sun, 16 Dec 2018 22:51:46 +0100
-Subject: Make the example config valid
-
----
- conf/corosync.conf.example | 22 +++++++---------------
- 1 file changed, 7 insertions(+), 15 deletions(-)
-
-diff --git a/conf/corosync.conf.example b/conf/corosync.conf.example
-index 4658a86..91de572 100644
---- a/conf/corosync.conf.example
-+++ b/conf/corosync.conf.example
-@@ -2,8 +2,10 @@
- totem {
- 	version: 2
- 
--	# Set name of the cluster
--	cluster_name: ExampleCluster
-+	# Corosync itself works without a cluster name, but DLM needs one.
-+	# The cluster name is also written into the VG metadata of newly
-+	# created shared LVM volume groups, if lvmlockd uses DLM locking.
-+	cluster_name: debian
- 
- 	# crypto_cipher and crypto_hash: Used for mutual node authentication.
- 	# If you choose to enable this, then do remember to create a shared
-@@ -25,7 +27,7 @@ logging {
- 	# Log to a log file. When set to "no", the "logfile" option
- 	# must not be set.
- 	to_logfile: yes
--	logfile: /var/log/cluster/corosync.log
-+	logfile: /var/log/corosync/corosync.log
- 	# Log to the system log daemon. When in doubt, set to yes.
- 	to_syslog: yes
- 	# Log debug messages (very verbose). When in doubt, leave off.
-@@ -41,7 +43,7 @@ logging {
- quorum {
- 	# Enable and configure quorum subsystem (default: off)
- 	# see also corosync.conf.5 and votequorum.5
--	#provider: corosync_votequorum
-+	provider: corosync_votequorum
- }
- 
- nodelist {
-@@ -53,19 +55,9 @@ nodelist {
- 		# Cluster membership node identifier
- 		nodeid: 1
- 		# Address of first link
--		#ring0_addr: 192.168.0.1
-+		ring0_addr: 127.0.0.1
- 		# When knet transport is used it's possible to define up to 8 links
- 		#ring1_addr: 192.168.1.1
- 	}
--	node {
--		# Hostname of the node
--		name: node2
--		# Cluster membership node identifier
--		nodeid: 2
--		# Address of first link
--		#ring0_addr: 192.168.0.2
--		# When knet transport is used it's possible to define up to 8 links
--		#ring1_addr: 192.168.1.2
--	}
- 	# ...
- }
diff --git a/debian/corosync.install b/debian/corosync.install
index bfaca759..c5b92661 100644
--- a/debian/corosync.install
+++ b/debian/corosync.install
@@ -25,7 +25,7 @@ usr/share/doc/corosync/AUTHORS
 usr/share/doc/corosync/INSTALL
 usr/share/augeas/lenses/corosync.aug
 usr/share/augeas/lenses/tests/test_corosync.aug
-etc/corosync/corosync.conf
+etc/corosync/corosync.*example* usr/share/doc/corosync/examples
 etc/corosync/uidgid.d
 usr/share/corosync/xml2conf.xsl
 var/lib/corosync
diff --git a/debian/rules b/debian/rules
index 52ff4699..50d89e2a 100755
--- a/debian/rules
+++ b/debian/rules
@@ -54,11 +54,8 @@ override_dh_auto_test-indep:
 override_dh_auto_install-indep:
 	$(MAKE) -C man DESTDIR="$(CURDIR)/debian/tmp" install
 
-CONF=debian/tmp/etc/corosync/corosync.conf
 override_dh_auto_install-arch:
 	dh_auto_install
-# We patched the example into a working config file:
-	mv -v $(CONF).example $(CONF)
 	rm -v debian/tmp/usr/lib/*/lib*.la
 # we don't need the upstream license
 	rm debian/tmp/usr/share/doc/corosync/LICENSE
