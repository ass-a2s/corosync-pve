From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fabian=20Gr=C3=BCnbichler?= <f.gruenbichler@proxmox.com>
Date: Mon, 13 Mar 2017 13:27:49 +0100
Subject: [PATCH] only start corosync.service if conf exists
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Fabian Gr√ºnbichler <f.gruenbichler@proxmox.com>
---
 init/corosync.service.in                                                | 1 +
 .../patches/Add-Documentation-URIs-to-the-systemd-service-files.patch   | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/init/corosync.service.in b/init/corosync.service.in
index d71a8572..3b8316a7 100644
--- a/init/corosync.service.in
+++ b/init/corosync.service.in
@@ -1,6 +1,7 @@
 [Unit]
 Description=Corosync Cluster Engine
 ConditionKernelCommandLine=!nocluster
+ConditionPathExists=/etc/corosync/corosync.conf
 Requires=network-online.target
 After=network-online.target
 
diff --git a/debian/patches/Add-Documentation-URIs-to-the-systemd-service-files.patch b/debian/patches/Add-Documentation-URIs-to-the-systemd-service-files.patch
index d77faae9..e9f25e45 100644
--- a/debian/patches/Add-Documentation-URIs-to-the-systemd-service-files.patch
+++ b/debian/patches/Add-Documentation-URIs-to-the-systemd-service-files.patch
@@ -52,5 +52,5 @@ index d71a857..12193b1 100644
  Description=Corosync Cluster Engine
 +Documentation=man:corosync man:corosync.conf man:corosync_overview
  ConditionKernelCommandLine=!nocluster
+ ConditionPathExists=/etc/corosync/corosync.conf
  Requires=network-online.target
- After=network-online.target
-- 
2.14.2

